#!/usr/bin/env bash
#MISE dir="{{cwd}}"
#MISE description="Uninstall cursor hook from current project"
#USAGE arg "<name>" help="Hook name (e.g., pre-tool-call, post-tool-call)"
set -euo pipefail

HOOKS_FILE=".cursor/hooks.json"
HOOK_NAME="${usage_name}"

if [[ ! -f "$HOOKS_FILE" ]]; then
    echo "No hooks.json found at $HOOKS_FILE"
    exit 1
fi

# Use jq to remove the hook from the hooks object
jq --arg name "$HOOK_NAME" 'del(.hooks[$name])' "$HOOKS_FILE" >"$HOOKS_FILE.tmp" &&
    mv "$HOOKS_FILE.tmp" "$HOOKS_FILE"

echo "Uninstalled hook '$HOOK_NAME'"
