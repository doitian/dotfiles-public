#!/bin/bash

function main() {
  local session="$1"
  shift
  if ! $(tmux has-session -t "$session"); then
    if [ -f "$HOME/.tmux-up/${session}.conf" ]; then
      exec TMUX= tmux-up "$HOME/.tmux-up/${session}.conf"
    else
      env TMUX= tmux new-session -d -s "$session" "$@"
    fi
  fi

  if [ -z "$TMUX" ]; then
    tmux -u attach-session -t "$session" "$@"
  else
    tmux -u switch-client -t "$session"
  fi
}

main "$@"
