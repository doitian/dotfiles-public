#!/bin/bash

main() {
  for session in $(tmux list-panes -a -F '#S' | uniq -u | grep '^[0-9]*$'); do
    if [ "$(tmux list-panes -t "$session" -F '#{pane_current_command}')" = "$(basename $SHELL)" ]; then
      tmux kill-session -t "=$session"
    fi
  done
}

main
