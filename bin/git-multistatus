#!/usr/bin/env zsh

ZSH=~/.fresh/source/robbyrussell/oh-my-zsh

source "$ZSH/lib/git.zsh"
source "$ZSH/plugins/gitfast/git-prompt.sh"

main() {
  local GIT_PS1_SHOWUPSTREAM="verbose,name"
  local ZSH_THEME_GIT_PROMPT_DIRTY="*"
  local ZSH_THEME_GIT_PROMPT_CLEAN=""
  local dirty

  for repo; do
    cd "$repo"

    if [ -n "$(parse_git_dirty)" ]; then
      printf "%b\e[0m\t%s\n" "\e[31m$(__git_ps1 '%s')" "$(realpath "$repo")"
    else
      printf "%b\e[0m\t%s\n" "\e[32m$(__git_ps1 '%s')" "$(realpath "$repo")"
    fi
  done
}

main "$@"
