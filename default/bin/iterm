#!/usr/bin/env bash

# Run a command in a new iterm window, examples:
#
#   iterm vim ~/.vimrc

set -e
set -u
[ -n "${DEBUG:-}" ] && set -x || true

export LANG=C.UTF-8

COMMAND="$*"
if [[ "$#" > 1 ]]; then
  COMMAND="$(printf '%q ' "$@")"
else
  COMMAND="$*"
fi

osascript -l JavaScript -e 'function run(arg) {
  const iterm = Application("iTerm");
  const window = iterm.createWindowWithDefaultProfile();
  iterm.write(window.currentSession, {text: arg});
}' "$COMMAND"
