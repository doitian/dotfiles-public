#!/bin/bash

DIR="$(mktemp -d)"
trap "rm -rf $DIR" exit

FILENAME="$*"
if [ -z "$FILENAME" ]; then
  FILENAME=clipboard
elif [[ $FILENAME == .* ]]; then
  FILENAME="clipboard.$FILENAME"
fi

pbpaste > "$DIR/$FILENAME"
if mvim -f +"cd $DIR" "$DIR/$FILENAME"; then
  pbcopy < "$DIR/$FILENAME"
fi
