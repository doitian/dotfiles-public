#compdef tmuxinator
#autoload

local curcontext="$curcontext" ret=1 line
local -a commands
local -a projectlist

commands=(
  "start:start a tmux session using project's tmuxinator config"
  "open:create a new project file and open it in your editor"
  "copy:copy source_project project file to a new project called new_project"
  "delete:deletes the project called project_name"
  "implode:deletes all existing projects!"
  "list:list all existing projects"
  "doctor:look for problems in your configuration"
  "help:shows this help document"
  "version:shows tmuxinator version number"
)

if ((CURRENT == 2)); then
  _describe -t commands 'tmuxinator command' commands && ret=0
else
  shift words
  (( CURRENT -- ))
  case "$words[1]" in
    start|open|delete|copy)
      projectlist=($(find -H $HOME/.tmuxinator -name '*.yml' -printf "%P\n" | sed 's/\.yml$//'))
      _describe -t projectlist 'tmuxinator project' projectlist && ret=0
      ;;
    *)
      ret=0
      ;;
  esac
fi
